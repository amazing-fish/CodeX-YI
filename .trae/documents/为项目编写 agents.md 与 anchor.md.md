## 目标

* 基于“锚点（Anchor）”方法，建立两份可操作文档：`agents.md` 与 `anchor.md`

* 规范与AI协作的工作流、提示词模板、审计与验证机制，降低遗忘与偏差

* 符合当前项目环境约定（Windows + PowerShell；默认中文回复）

## 文档交付

* 更新现有文件：`d:\Develop\Project\GitHub\CodeX-YI-1\Agents.md`（统一内容为“agents.md”的规范）

* 新增文件：`anchor.md`（项目“元约定”与14个版本变更日志的锚点文档）

## 文章要点分析（提炼为规则）

* 在每次小改动前通读锚点文档；完成后维护锚点文档，形成“元约定”先于所有约定

* 锚点文档包含顶层/中层设定、模块拆分、逻辑链路、协作约定

* 保留最近14个版本的变更记录，显著降低遗忘与关联逻辑丢失

## agents.md 结构与内容

* 目的：统一AI编码协作角色、工作流程、提示词与审计规范

* 角色

  * `Owner Agent`：端到端负责，拆解任务、把关质量

  * `Search Agent`：代码/概念检索与综述（优先用于架构与跨域搜索）

  * `Code Reviewer`：风格一致性、风险点、复杂度与安全检查

  * `Test Runner`：测试方案设计与执行（单测、预览、脚本）

  * `Docs Maintainer`：维护`anchor.md`与审计记录

* 全局约定

  * 回复语言：中文；引用代码位置使用`file_path:line_number`

  * 环境：Windows + PowerShell

  * 提交：除用户明确要求外不提交；以补丁提案与验证结果先行

  * 风格：尊重项目现有库与风格；先查后用，不假设依赖存在

* 工作流

  * 任务拟定 → 使用待办（单一`in_progress`）→ 实施 → 验证（测试/预览）→ 审计记录

  * 搜索策略：高层概念与全局连接优先交给`Search Agent`

  * 验证策略：单测或预览；必要时构建最小复现

* 提示词模板（节选）

  * Bug修复：问题现象/期望/影响范围/相关文件/验证方案

  * 功能实现：需求要点/边界条件/依赖检查/数据流/接口/验证与回滚

  * 代码评审：一致性/复杂度/边界/测试覆盖/变更影响

  * 检索综述：主题/范围/关键词/预期产出（文件列表、位置、摘要）

* 决策清单

  * 是否需要检索代理？是否已有相同模式的实现？是否具备可验证路径？是否触及安全或依赖风险？

* 审计与可追溯

  * 每次改动输出：变更文件列表、补丁摘要、验证步骤与结果、风险与后续事项

## anchor.md 结构与内容

* 目的：项目“元约定”的单一真源（Single Source of Truth），辅助AI/开发者在每次改动前后对齐

* 顶层约定

  * 语言与沟通：默认中文；引用代码用`file_path:line_number`

  * 环境与命令：Windows + PowerShell

  * 安全与合规：不提交密钥；第三方依赖需先验证存在与版本兼容

  * 提交策略：仅在用户明确要求时提交；优先以补丁与验证输出评审

* 项目地图（占位待维护）

  * 模块列表：名称/职责/关键入口/主要依赖

  * 关键逻辑链路：如认证/错误处理/配置加载/IO边界

* 工作流程与检查清单

  * 改动前：通读本锚点；确认依赖与影响范围；确定验证方案

  * 改动后：更新锚点涉及的设定/地图/逻辑；记录审计与验证结果

* 14个版本变更日志（模板示例）

  * `v主.次.修`：改动概述；影响模块；验证结果；后续事项

  * 保留最近14个版本变更日志，超过转归档

* 互动规则

  * AI需在每次任务前后引用并维护本文件；保持“元约定”优先级最高

## 实施步骤

* 步骤1：读取现有`Agents.md`并以上述结构填充/重构

* 步骤2：在仓库根目录新增`anchor.md`并写入上述结构与模板

* 步骤3：为两文档添加首版提示词与检查清单，与项目环境约定对齐

* 步骤4：验证流程

  * 通过一次模拟小改动（不提交）演练：从读取锚点→执行→更新锚点→输出审计

## 验证与维护

* 验证：执行一次“最小改动”演练并输出审计记录，确保文档可操作

* 维护：每日更新14个版本变更日志；模块与逻辑链路随改动更新

* 评审：后续由`Code Reviewer`按清单进行一致性与风险评审

## 接受标准

* 两份文档结构清晰、可直接复用，落地到当前项目环境

* 至少包含：角色与工作流、提示词模板、审计与验证机制、14个版本变更日志模板

* 完成一次演练，证明文档能指导稳定协作

